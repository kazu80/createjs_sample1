<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Demo 2</title>
    <script src="https://code.createjs.com/createjs-2015.11.26.min.js"></script>
    <script>
        // 読み込みが終わってから初期化
        window.addEventListener ('load', init);

        function init () {
            // 初期化
            const stage = new createjs.Stage ('myCanvas');

            const options = [];
            const balls = [];

            for (let i = 0; i < 20; i++) {
                // 円を作成します
                const ball = new createjs.Shape ();

                ball.graphics.beginFill ('DarkRed'); // 赤色で描画するように設定
                ball.graphics.drawCircle (0, 0, 5); //半径 100px の円を描画
                stage.addChild (ball); // 表示リストに追加

                ball.x = stage.canvas.width * Math.random ();
                ball.y = stage.canvas.height + 10;

                balls[i] = ball;
                options[i] = {
                    centerX: ball.x,
                    angle  : 0
                };
            }

            const range = 10; // 振り幅
            const xSpeed = 0.09; // 振り幅スピード
            const ySpeed = -1; // 上りスピード

            // 時間経過
            createjs.Ticker.addEventListener ('tick', handleTick);

            function handleTick () {

                for (let i = 0; i < balls.length; i++) {
                    const ball = balls[i];
                    const option = options[i];

                    ball.x = option.centerX + Math.sin (option.angle) * range;
                    ball.y += ySpeed;

                    // Set Math.sin (angle)
                    options[i].angle += xSpeed;

                    // 画面端の処理
                    if (ball.y < 0) {
                        ball.y = stage.canvas.height + 10;
                        ball.x = stage.canvas.width * Math.random ();
                        options[i].centerX = ball.x;
                    }
                }

                stage.update ();
            }

            // 画面更新の頻度を60FPSに設定
            // createjs.Ticker.timingMode = createjs.Ticker.RAF;
            createjs.Ticker.framerate = 33;
        }
    </script>
</head>
<body>
<canvas id="myCanvas" width="640" height="600"></canvas>
</body>
</html>